{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zunoâ€™s DEI Mission - Intro</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>

    <!-- ðŸŽ¥ Background Video -->
    <video id="introVideo" autoplay muted loop>
        <source src="{% static 'videos/intro.mp4' %}" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- ðŸŒ‘ Optional Dark Overlay -->
    <div class="overlay"></div>

    <!-- ðŸš€ Start Button -->
    <a href="{% url 'map' %}">
        <button class="start-button">Begin Zunoâ€™s Journey ðŸš€</button>
    </a>

    <!-- ðŸ”‡ Mute / Unmute Toggle -->
    <button class="mute-button" onclick="toggleMute()">ðŸ”‡ Sound Off</button>

    <!-- ðŸ§  JS: Mute toggle + Voice narration -->
    <script>
        const video = document.getElementById("introVideo");

        function toggleMute() {
            video.muted = !video.muted;
            const btn = document.querySelector(".mute-button");
            btn.textContent = video.muted ? "ðŸ”‡ Sound Off" : "ðŸ”Š Sound On";
            if (!video.paused) video.play(); // Resume playback if paused
        }

        function speakText() {
            const text = "Sources confirm an intergalactic visitor named Zuno has arrived on a mission to study human behavior and promote diversity, equity, and inclusion on Earth.";
            const speech = new SpeechSynthesisUtterance(text);
            speech.lang = "en-US";

            const voices = window.speechSynthesis.getVoices();
            const voice = voices.find(v => v.name.includes("Female") || v.name.includes("Google UK English Female") || v.name.includes("Google US English"));
            if (voice) speech.voice = voice;

            speech.rate = 1;
            speech.pitch = 1.2;
            speech.volume = 1;

            window.speechSynthesis.speak(speech);
        }

        window.speechSynthesis.onvoiceschanged = () => {
            video.addEventListener("play", () => {
                if (!video.hasSpoken) {
                    speakText();
                    video.hasSpoken = true;
                }
            });
        };
    </script>

</body>
</html>
